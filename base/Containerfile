FROM quay.io/fedora-ostree-desktops/sway-atomic:41 as release
ARG ZELLIJ_URL="https://rpmfind.net/linux/opensuse/tumbleweed/repo/oss/x86_64/zellij-0.42.0-1.1.x86_64.rpm"
LABEL name="$NAME" \
    summary="Fedora Silverblue SWAY Base container" \
    maintainer="Joe Terlecki"

RUN echo "net.ipv4.ip_forward=1" > /etc/sysctl.d/99-ip-forward.conf && \
    echo "net.ipv6.conf.all.forwarding=1" >> /etc/sysctl.d/99-ip-forward.conf

COPY ./yum.repos.d/*.repo /etc/yum.repos.d/

RUN rpm-ostree override remove firefox firefox-langpacks \
    && rpm-ostree install \
    tailscale \
    zsh \
    alacritty \
    ${ZELLIJ_URL} \
    && rpm-ostree cleanup -m \
    && ostree container commit
